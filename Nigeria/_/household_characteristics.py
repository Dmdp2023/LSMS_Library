regions=[[1, "North central"], [2, "North east"], [3, "North west"], [4, "South east"], [5, "South south"], [6, "South west"]]
url=[["https://docs.google.com/spreadsheets/d/1whE_EW5x-jxrsKvYWfefdBppzp_TZhPP61bdEN-FEJ4/"]]
VARS=[["t", "Output", "File", "Grouping", "Mapping"], ["2010Q3", "M 00-03", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==1)"], ["2010Q3", "M 04-08", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==1)"], ["2010Q3", "M 09-13", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==1)"], ["2010Q3", "M 14-18", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==1)"], ["2010Q3", "M 19-30", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==1)"], ["2010Q3", "M 31-50", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==1)"], ["2010Q3", "M 51+", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==1)"], ["2010Q3", "F 00-03", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==2)"], ["2010Q3", "F 04-08", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==2)"], ["2010Q3", "F 09-13", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==2)"], ["2010Q3", "F 14-18", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==2)"], ["2010Q3", "F 19-30", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==2)"], ["2010Q3", "F 31-50", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==2)"], ["2010Q3", "F 51+", "../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==2)"], ["2012Q3", "M 00-03", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==1)"], ["2012Q3", "M 04-08", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==1)"], ["2012Q3", "M 09-13", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==1)"], ["2012Q3", "M 14-18", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==1)"], ["2012Q3", "M 19-30", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==1)"], ["2012Q3", "M 31-50", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==1)"], ["2012Q3", "M 51+", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==1)"], ["2012Q3", "F 00-03", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==2)"], ["2012Q3", "F 04-08", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==2)"], ["2012Q3", "F 09-13", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==2)"], ["2012Q3", "F 14-18", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==2)"], ["2012Q3", "F 19-30", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==2)"], ["2012Q3", "F 31-50", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==2)"], ["2012Q3", "F 51+", "../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==2)"], ["2015Q3", "M 00-03", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==1)"], ["2015Q3", "M 04-08", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==1)"], ["2015Q3", "M 09-13", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==1)"], ["2015Q3", "M 14-18", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==1)"], ["2015Q3", "M 19-30", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==1)"], ["2015Q3", "M 31-50", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==1)"], ["2015Q3", "M 51+", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==1)"], ["2015Q3", "F 00-03", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==2)"], ["2015Q3", "F 04-08", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==2)"], ["2015Q3", "F 09-13", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==2)"], ["2015Q3", "F 14-18", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==2)"], ["2015Q3", "F 19-30", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==2)"], ["2015Q3", "F 31-50", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==2)"], ["2015Q3", "F 51+", "../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==2)"], ["2018Q3", "M 00-03", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==1)"], ["2018Q3", "M 04-08", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==1)"], ["2018Q3", "M 09-13", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==1)"], ["2018Q3", "M 14-18", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==1)"], ["2018Q3", "M 19-30", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==1)"], ["2018Q3", "M 31-50", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==1)"], ["2018Q3", "M 51+", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==1)"], ["2018Q3", "F 00-03", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==2)"], ["2018Q3", "F 04-08", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==2)"], ["2018Q3", "F 09-13", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==2)"], ["2018Q3", "F 14-18", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==2)"], ["2018Q3", "F 19-30", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==2)"], ["2018Q3", "F 31-50", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==2)"], ["2018Q3", "F 51+", "../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==2)"], ["2011Q1", "M 00-03", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==1)"], ["2011Q1", "M 04-08", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==1)"], ["2011Q1", "M 09-13", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==1)"], ["2011Q1", "M 14-18", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==1)"], ["2011Q1", "M 19-30", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==1)"], ["2011Q1", "M 31-50", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==1)"], ["2011Q1", "M 51+", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==1)"], ["2011Q1", "F 00-03", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 0) & (x.s1q4 < 4) & (x.s1q2 ==2)"], ["2011Q1", "F 04-08", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 4) & (x.s1q4 < 9) & (x.s1q2 ==2)"], ["2011Q1", "F 09-13", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 9) & (x.s1q4 < 14) & (x.s1q2 ==2)"], ["2011Q1", "F 14-18", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 14) & (x.s1q4 < 19) & (x.s1q2 ==2)"], ["2011Q1", "F 19-30", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 19)  & (x.s1q4 < 31) & (x.s1q2 ==2)"], ["2011Q1", "F 31-50", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 31) & (x.s1q4 < 51) & (x.s1q2 ==2)"], ["2011Q1", "F 51+", "../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "('j',sum)", "lambda x: 0 + (x.s1q4 >= 51) & (x.s1q2 ==2)"], ["2013Q1", "M 00-03", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==1)"], ["2013Q1", "M 04-08", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==1)"], ["2013Q1", "M 09-13", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==1)"], ["2013Q1", "M 14-18", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==1)"], ["2013Q1", "M 19-30", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==1)"], ["2013Q1", "M 31-50", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==1)"], ["2013Q1", "M 51+", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==1)"], ["2013Q1", "F 00-03", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==2)"], ["2013Q1", "F 04-08", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==2)"], ["2013Q1", "F 09-13", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==2)"], ["2013Q1", "F 14-18", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==2)"], ["2013Q1", "F 19-30", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==2)"], ["2013Q1", "F 31-50", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==2)"], ["2013Q1", "F 51+", "../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==2)"], ["2016Q1", "M 00-03", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==1)"], ["2016Q1", "M 04-08", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==1)"], ["2016Q1", "M 09-13", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==1)"], ["2016Q1", "M 14-18", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==1)"], ["2016Q1", "M 19-30", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==1)"], ["2016Q1", "M 31-50", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==1)"], ["2016Q1", "M 51+", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==1)"], ["2016Q1", "F 00-03", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==2)"], ["2016Q1", "F 04-08", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==2)"], ["2016Q1", "F 09-13", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==2)"], ["2016Q1", "F 14-18", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==2)"], ["2016Q1", "F 19-30", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==2)"], ["2016Q1", "F 31-50", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==2)"], ["2016Q1", "F 51+", "../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==2)"], ["2019Q1", "M 00-03", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==1)"], ["2019Q1", "M 04-08", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==1)"], ["2019Q1", "M 09-13", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==1)"], ["2019Q1", "M 14-18", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==1)"], ["2019Q1", "M 19-30", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==1)"], ["2019Q1", "M 31-50", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==1)"], ["2019Q1", "M 51+", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==1)"], ["2019Q1", "F 00-03", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 0) & (x.s1q6 < 4) & (x.s1q2 ==2)"], ["2019Q1", "F 04-08", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 4) & (x.s1q6 < 9) & (x.s1q2 ==2)"], ["2019Q1", "F 09-13", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 9) & (x.s1q6 < 14) & (x.s1q2 ==2)"], ["2019Q1", "F 14-18", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 14) & (x.s1q6 < 19) & (x.s1q2 ==2)"], ["2019Q1", "F 19-30", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 19)  & (x.s1q6 < 31) & (x.s1q2 ==2)"], ["2019Q1", "F 31-50", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 31) & (x.s1q6 < 51) & (x.s1q2 ==2)"], ["2019Q1", "F 51+", "../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "('j',sum)", "lambda x: 0 + (x.s1q6 >= 51) & (x.s1q2 ==2)"]]
INDICES=[["File", "j", "t", "m"], ["../../Nigeria/2010-11/Data/sect1_harvestw1.csv", "hhid", "2010Q3", "zone"], ["../../Nigeria/2012-13/Data/sect1_harvestw2.csv", "hhid", "2012Q3", "zone"], ["../../Nigeria/2015-16/Data/sect1_harvestw3.csv", "hhid", "2015Q3", "zone"], ["../../Nigeria/2018-19/Data/sect1_harvestw4.csv", "hhid", "2018Q3", "zone"], ["../../Nigeria/2010-11/Data/sect1_plantingw1.csv", "hhid", "2011Q1", "zone"], ["../../Nigeria/2012-13/Data/sect1_plantingw2.csv", "hhid", "2013Q1", "zone"], ["../../Nigeria/2015-16/Data/sect1_plantingw3.csv", "hhid", "2016Q1", "zone"], ["../../Nigeria/2018-19/Data/sect1_plantingw4.csv", "hhid", "2019Q1", "zone"]]
from cfe.df_utils import orgtbl_to_df
from cfe.input_files import construct_df
import pandas as pd
import numpy as np
#from eep153_tools import write_sheet

url = url[0][0]

VARS = orgtbl_to_df(VARS)
INDICES = orgtbl_to_df(INDICES).set_index('File')

df=construct_df(VARS,INDICES,dvcstream=True)

# Rename regions
df = df.reset_index().replace({'m':dict(regions)}).set_index(['j','t','m'])

# Add up people
df = df.groupby(['j','t','m']).sum()

df['log HHSize'] = np.log(df.sum(axis=1))

# Make HH IDs strings
df.rename(index=lambda s: str(s),level='j',inplace=True) 

df.to_parquet('./z.parquet')

# Write to google sheet
#write_sheet(df,'ligon@berkeley.edu',user_role='writer',json_creds='instructors.json',
#            key=url,sheet='HH Characteristics')

print(df.groupby(['t','m']).mean())
print(df.head())
print(len(df))
